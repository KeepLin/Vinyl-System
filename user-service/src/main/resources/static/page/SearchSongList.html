<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>搜索歌单</title>
    <link rel="stylesheet" type="text/css" href="../plugins/element-ui/lib/theme-chalk/index.css">
</head>
<body>
<div id="SearchSongList">
    <template>
        <div class="play-list" v-for="(item,index) in pageList" :key="index">
            <ul class="play-body">
                <li class="card" v-for="(item,index) in pageList[index].list" :key="index">
                    <div @click="goAlbum(item,item.title)">
                        <el-image class="card-img" fit="contain" :src="picUrl+item.pic"></el-image>
                    </div>
                    <p class="card-name">{{ item.title }}</p>
                </li>
            </ul>
        </div>
        <el-drawer :visible.sync="table" direction="rtl" size="50%">
            <div>
                <el-card shadow="hover" :body-style="{ padding: '0px' }">
                    <div class="card-content">
                        <div class="card-left">
                            <el-image style="width: 80px;height: 80px" fit="contain" :src="imageUrl" ></el-image>
                        </div>
                        <div class="card-right">
                            <div class="card-num">{{Title}}</div>
                        </div>
                    </div>
                </el-card>
            </div>
            <div>
                <el-input type="textarea" v-model="Introduction" :autosize="{ minRows: 3, maxRows: 10}" readonly="true"></el-input>
            </div>
            <div>
                <el-input placeholder="搜索歌单音乐" v-model="SearchSong"  style="width: 200px;" class="filter-item" clearable></el-input>
                <el-button @click="getSongBySongListId()"  icon="el-icon-search" plain>查询</el-button>
            </div>
            <div>
                <el-table current-row-key="id" :data="dataList"  @row-click="handleClick" :row-class-name="tableRow" stripe highlight-current-row  border>
                    <el-table-column type="index" label="序号" align="center" width="50px"></el-table-column>
                    <el-table-column prop="name" label="歌曲名" align="center" >
                        <template slot-scope="scope">
                            <div>{{ replaceLName(scope.row.name) }}</div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="name" label="歌手" align="center" >
                        <template slot-scope="scope">
                            <div>{{ replaceFName(scope.row.name) }}</div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="album" label="专辑" align="center"></el-table-column>
                    <el-table-column prop="time" label="时长" align="center"></el-table-column>
                </el-table>
            </div>
        </el-drawer>
    </template>
</div>
<!-- 开发环境版本，包含了有帮助的命令行警告 -->
<script src="../plugins/vue/vue.js"></script>
<!-- 引入组件库 -->
<script src="../plugins/element-ui/lib/index.js"></script>
<!-- 引入axios -->
<script src="../plugins/axios/axios.min.js"></script>
<script>
    new Vue({
        el: '#SearchSongList',
        data:{
            SearchName: '',
            SearchSong: '',
            Title: '',
            Introduction: '',
            dataList: [],
            picUrl:'http://localhost:8081',
            imageUrl: '',
            table: false,
            pageList:[
                {name:"歌单",list:[]}
            ],
        },
        created(){
            this.SearchName = window.localStorage.getItem("SearchName");
        },
        mounted(){
            this.getSongByTitle();
        },
        methods:{
            getSongByTitle(){
                param = "?title="+this.SearchName;
                axios.get("/menu/SongByTitle"+param).then((res)=>{
                    this.pageList[0].list=res.data.data;
                })
            },
            //跳转歌单歌手页面
            goAlbum(item,type){
                this.SongListID = item.id;
                this.Title = item.title;
                this.Introduction = item.introduction;
                this.imageUrl = this.picUrl+item.pic;
                this.getSongBySongListId(item.id);
                this.table=true;
            },
            getSongBySongListId(){
                param = "?name="+this.SearchSong;
                axios.get("/menu/SongBySongListId/"+this.SongListID+param).then((res)=>{
                    this.dataList=res.data.data;
                })
            },
            replaceFName(str){
                let arr = str.split('-');
                return arr[0]
            },
            replaceLName(str){
                let arr = str.split('-');
                return arr[1]
            },
        }
    })
</script>
<style scoped>
    .swiper-container {
        width: 90%;
        margin: auto;
        padding-top: 20px;
    }
    .swiper-container img{
        width: 100%;
    }
    .play-list {
        padding: 0 5rem;
    }
    .play-list .play-title {
        height: 60px;
        line-height: 60px;
        font-size: 28px;
        font-weight: 500;
        text-align: center;
        color: black;
        box-sizing: border-box;
    }
    .play-list .play-body{
        display: flex;
        justify-content: flex-start;
        align-items:  stretch;
        flex-direction: row;
        flex-wrap: wrap;
    }
    .card {
        position: relative;
        height: 250px;
        width: 300px;
        padding-bottom: 2%;
        overflow: hidden;
        border-radius: 5px;
        padding-left: 30px;
    }
    .card .card-img {
        width: 200px;
        height: 200px;
        transition: all 0.4s ease;
    }
    .card .card-name {
        width: 200px;
        font-size: 20px;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        margin: 0.5rem 0;
    }
    .card-content {
        display: flex;
        align-items: center;
        justify-content: space-around;
        height: 100px;
        padding-left: 20%;
        text-align: center;
    }

    .card-left {
        display: flex;
        font-size: 3rem;
    }

    .card-right {
        flex: 1;
        font-size: 14px;
    }

    .card-num {
        font-size: 30px;
        font-weight: bold;
    }
    .play-body{
        display: flex;
        justify-content: flex-start;
        align-items:  stretch;
        flex-direction: row;
        flex-wrap: wrap;
    }

</style>
</body>
</html>