<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>音乐首页</title>
    <link rel="stylesheet" type="text/css" href="../plugins/element-ui/index.css">
</head>
<body>
<div id="app">
    <template>
        <div>
            <el-carousel class="swiper-container" type="card" height="280px" :interval="4000">
                <el-carousel-item v-for="(item, index) in picList" :key="index">
                    <img :src="picUrl+item" />
                </el-carousel-item>
            </el-carousel>
        </div>
        <div class="play-list" v-for="(item,index) in pageList" :key="index">
            <div class="play-title">{{item.name}}</div>
            <ul class="play-body">
                <li class="card" v-for="(item,index) in pageList[index].list" :key="index">
                    <div @click="goAlbum(item,item.name)">
                            <el-image class="card-img" fit="contain" :src="picUrl+item.pic" lazy></el-image>
                    </div>
                    <p class="card-name">{{ item.name || item.title }}</p>
                </li>
            </ul>
        </div>

        <el-drawer :visible.sync="DialogVisible" direction="rtl" size="50%">
            <div>
                <el-card shadow="hover" :body-style="{ padding: '0px' }">
                    <div class="card-content">
                        <div class="card-left">
                            <el-image style="width: 80px;height: 80px" fit="contain" :src="imageUrl" ></el-image>
                        </div>
                        <div class="card-right">
                            <div class="card-num">{{SingerName}}</div>
                        </div>
                    </div>
                </el-card>
            </div>
            <div>
            <el-input type="textarea" v-model="Introduction" :autosize="{ minRows: 3, maxRows: 10}" readonly="true"></el-input>
            </div>
            <div>
                <el-input placeholder="搜索歌单音乐" v-model="SearchName"  style="width: 200px;" class="filter-item" clearable></el-input>
                <el-button @click="getSongBySongListId()"  icon="el-icon-search" plain>查询</el-button>
            </div>
            <div>
                <el-table current-row-key="id" :data="dataList"  @row-click="handleClick" :row-class-name="tableRow" stripe highlight-current-row  border>
                    <el-table-column type="index" label="序号" align="center" width="50px"></el-table-column>
                    <el-table-column prop="name" label="歌曲名" align="center" >
                        <template slot-scope="scope">
                            <div>{{ replaceLName(scope.row.name) }}</div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="name" label="歌手" align="center" >
                        <template slot-scope="scope">
                            <div>{{ replaceFName(scope.row.name) }}</div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="album" label="专辑" align="center"></el-table-column>
                    <el-table-column prop="time" label="时长" align="center"></el-table-column>
                </el-table>
            </div>
        </el-drawer>

        <el-drawer :visible.sync="table" direction="rtl" size="50%">
            <div>
                <el-card shadow="hover" :body-style="{ padding: '0px' }">
                    <div class="card-content">
                        <div class="card-left">
                            <el-image style="width: 80px;height: 80px" fit="contain" :src="imageUrl" ></el-image>
                        </div>
                        <div class="card-right">
                            <div class="card-num">{{SingerName}}</div>
                        </div>
                    </div>
                </el-card>
            </div>
            <div>
                <el-input type="textarea" v-model="Introduction"  readonly="true" :autosize="{ minRows: 2, maxRows: 6}"></el-input>
            </div>
            <div>
                <el-table current-row-key="id" :data="dataList"  @row-click="handleClick" :row-class-name="tableRow" stripe highlight-current-row  border>
                    <el-table-column type="index" label="序号" align="center" width="50px"></el-table-column>
                    <el-table-column prop="name" label="歌曲名" align="center" >
                        <template slot-scope="scope">
                            <div>{{ replaceLName(scope.row.name) }}</div>
                        </template>
                    </el-table-column>
                    <el-table-column prop="album" label="专辑" align="center"></el-table-column>
                    <el-table-column prop="time" label="时长" align="center"></el-table-column>
                </el-table>
            </div>
        </el-drawer>
    </template>


</div>


<!-- 开发环境版本，包含了有帮助的命令行警告 -->
<script src="../plugins/vue/vue.js"></script>
<!-- 引入组件库 -->
<script src="../plugins/element-ui/index.js"></script>
<!-- 引入axios -->
<script src="../plugins/axios/axios.min.js"></script>
<script>
    new Vue({
        el: '#app',
        data:{
            dataList: [],
            picUrl:'http://localhost:8081',
            imageUrl: '', //歌手头像
            pic: '', //歌曲图片
            picList:[
                '/img/swiper/1.jpg',
                '/img/swiper/2.jpg',
                '/img/swiper/3.jpg',
                '/img/swiper/4.jpg',
                '/img/swiper/5.jpg',
                '/img/swiper/6.jpg'
            ],
            pageList:[
                {name:"歌单",list:[]},
                {name:"歌手",list:[]},
            ],
            SearchName: '',  //搜索词
            SongListID: '',  //歌单ID
            SingerName: '',  //歌手姓名
            Introduction: '',//歌手简介
            musicUrl:'',    //歌曲路径
            title: '',     //歌名
            artist: '',     //歌手名
            listIndex: 0,     //歌单中的位置
            DialogVisible: false,
            table: false,
            theControlList: {},
        },
        created(){

        },
        mounted(){
            this.getSingerList();
            this.getSongList();
        },
        methods:{
            handleCommand(command) {
                this.musicUrl=command.url;
                this.title = this.replaceLName(command.name);
                this.artist = this.replaceFName(command.name);
                this.pic = command.pic;
            },
            //获取歌手
            getSingerList(){
                axios.get("/menu/singer").then((res)=>{
                    this.pageList[1].list=res.data.data.slice(0,10);
                })

            },
            //获取歌单
            getSongList(){
                axios.get("/menu/songList").then((res)=>{
                    this.pageList[0].list=res.data.data.slice(0,10);
                })
            },
            //跳转歌单歌手页面
            goAlbum(item,type){
                if(type != null){
                    this.SingerName = type;
                    this.Introduction = item.introduction;
                    this.imageUrl = this.picUrl+item.pic;
                    this.getSongById(item.id);
                    this.table = true;
                }else {
                    this.SongListID = item.id;
                    this.SingerName = item.title;
                    this.Introduction = item.introduction;
                    this.imageUrl = this.picUrl+item.pic;
                    this.getSongBySongListId(item.id);
                    this.DialogVisible=true;
                }

            },
            getSongById(id){
                axios.get("/menu/SongBySingerId/"+id).then((res)=>{
                    this.dataList=res.data.data;
                })
            },
            getSongBySongListId(){
                param = "?name="+this.SearchName;
                axios.get("/menu/SongBySongListId/"+this.SongListID+param).then((res)=>{
                    this.dataList=res.data.data;
                })
            },
            replaceFName(str){
                let arr = str.split('-');
                return arr[0]
            },
            replaceLName(str){
                let arr = str.split('-');
                return arr[1]
            },
            tableRow({row,rowIndex}){
                row.index=rowIndex;
            },
            handleClick(row){
                this.musicUrl=row.url;
                this.title = this.replaceLName(row.name);
                this.artist = this.replaceFName(row.name);
                this.pic = row.pic;
                this.listIndex = row.index;
            },


        },


    })
</script>
<style scoped>
    .swiper-container {
        width: 90%;
        margin: auto;
        padding-top: 20px;
    }
    .swiper-container img{
        width: 100%;
    }
    .play-list {
        padding: 0 5rem;
    }
    .play-list .play-title {
        height: 60px;
        line-height: 60px;
        font-size: 28px;
        font-weight: 500;
        text-align: center;
        color: black;
        box-sizing: border-box;
    }
    .play-list .play-body{
        display: flex;
        justify-content: flex-start;
        align-items:  stretch;
        flex-direction: row;
        flex-wrap: wrap;
    }
    .card {
        position: relative;
        height: 250px;
        width: 300px;
        padding-bottom: 2%;
        overflow: hidden;
        border-radius: 5px;
        padding-left: 30px;
    }
    .card .card-img {
        width: 200px;
        height: 200px;
        transition: all 0.4s ease;
    }
    .card .card-name {
        width: 200px;
        font-size: 20px;
        text-align: center;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        margin: 0.5rem 0;
    }
    .card-content {
        display: flex;
        align-items: center;
        justify-content: space-around;
        height: 100px;
        padding-left: 20%;
        text-align: center;
    }

    .card-left {
        display: flex;
        font-size: 3rem;
    }

    .card-right {
        flex: 1;
        font-size: 14px;
    }

    .card-num {
        font-size: 30px;
        font-weight: bold;
    }
    .play-body{
        display: flex;
        justify-content: flex-start;
        align-items:  stretch;
        flex-direction: row;
        flex-wrap: wrap;
    }
    .slider {
        width: 100px;
        margin-top: 10px;
        text-align: center;
    }
    .slider_time{
        width: 550px;
        margin: 0 10px;
    }
    .slider_voice{
        width: 100px;
        margin-top: 5px;
    }
    .download {
        color: #409EFF;
        margin-left: 15px;
        width: 100px;
        text-align: center;
        margin-top: 10px;
    }
    .dn{
        display: none;
    }
    .Title{
        margin-right: 30px;
        margin-left: 30px;
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        color: #DD4A68;
        height: 50px;
    }
</style>
</body>
</html>